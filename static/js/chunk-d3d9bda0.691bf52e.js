(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d3d9bda0","chunk-2d224e96"],{6087:function(t,e,a){"use strict";a("caab")},c843:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"system-poem-container layout-padding"},[a("el-card",{staticClass:"layout-padding-auto",attrs:{shadow:"hover"}},[a("div",{staticClass:"poem-section"},[a("h3",{staticClass:"poem-section-title"},[t._v("Today's Poem ("+t._s(t.state.todayPoem?1:0)+"/1)")]),t.state.todayPoem?a("div",{staticClass:"poem-grid"},[a("el-card",{staticClass:"poem-card poem-card-today",attrs:{"body-style":{padding:"0px"}},nativeOn:{click:function(e){return t.viewPoemDetail(t.state.todayPoem)}}},[a("div",{staticClass:"poem-image-container"},[a("img",{staticClass:"poem-image",attrs:{src:t.state.todayPoem.accessUrl}})]),a("div",{staticClass:"poem-content"},[a("h4",[t._v(t._s(t.state.todayPoem.title))]),a("p",{staticClass:"poem-text"},[t._v(t._s(t.state.todayPoem.content))]),a("div",{staticClass:"poem-meta"},[a("span",[t._v(t._s(t.state.todayPoem.authorName))]),a("el-tag",{attrs:{size:"mini",type:"success"}},[t._v("Today's Poem")])],1)])])],1):t._e()]),a("div",{staticClass:"poem-section"},[a("h3",{staticClass:"poem-section-title"},[t._v("Featured Poems ("+t._s(t.state.featuredPoems.length)+"/4)")]),t.state.featuredPoems.length>0?a("div",{staticClass:"poem-grid"},[t._l(t.state.featuredPoems,(function(e){return a("div",{key:e.id,staticClass:"poem-grid-item"},[a("el-card",{staticClass:"poem-card poem-card-featured",attrs:{"body-style":{padding:"0px"}},nativeOn:{click:function(a){return t.viewPoemDetail(e)}}},[a("div",{staticClass:"poem-image-container"},[a("img",{staticClass:"poem-image",attrs:{src:e.accessUrl}})]),a("div",{staticClass:"poem-content"},[a("h4",[t._v(t._s(e.title))]),a("p",{staticClass:"poem-text"},[t._v(t._s(e.content))]),a("div",{staticClass:"poem-meta"},[a("span",[t._v(t._s(e.authorName))]),a("el-tag",{attrs:{size:"mini"}},[t._v("Featured")])],1),a("div",{staticClass:"poem-actions"},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(a){return a.stopPropagation(),t.toggleFeaturedPoem(e)}}},[t._v("Cancel")])],1)])])],1)}))],2):t._e()]),a("div",{staticClass:"poem-section"},[a("h3",{staticClass:"poem-section-title"},[t._v("Favorite Poems ("+t._s(t.state.favoritePoems.length)+"/5)")]),t.state.favoritePoems.length>0?a("div",{staticClass:"poem-grid"},[t._l(t.state.favoritePoems,(function(e){return a("div",{key:e.id,staticClass:"poem-grid-item"},[a("el-card",{staticClass:"poem-card poem-card-favorite",attrs:{"body-style":{padding:"0px"}},nativeOn:{click:function(a){return t.viewPoemDetail(e)}}},[a("div",{staticClass:"poem-image-container"},[a("img",{staticClass:"poem-image",attrs:{src:e.accessUrl}})]),a("div",{staticClass:"poem-content"},[a("h4",[t._v(t._s(e.title))]),a("p",{staticClass:"poem-text"},[t._v(t._s(e.content))]),a("div",{staticClass:"poem-meta"},[a("span",[t._v(t._s(e.authorName))]),a("el-tag",{attrs:{size:"mini",type:"warning"}},[t._v("Favorite")])],1),a("div",{staticClass:"poem-actions"},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(a){return a.stopPropagation(),t.toggleFavoritePoem(e)}}},[t._v("Cancel")])],1)])])],1)}))],2):t._e()]),a("div",{staticClass:"poem-display-area"},[a("div",{staticClass:"poem-section"},[a("h3",{staticClass:"poem-section-title"},[t._v("All Submitted Poems")]),a("div",{staticClass:"system-poem-search mb15"},[a("el-input",{staticStyle:{"max-width":"300px"},attrs:{placeholder:"Enter poem title",clearable:""},on:{clear:t.handleSearchClear,keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.fetchData.apply(null,arguments)}},scopedSlots:t._u([{key:"append",fn:function(){return[a("el-button",{attrs:{icon:"el-icon-search"},on:{click:t.fetchData}})]},proxy:!0}]),model:{value:t.state.title,callback:function(e){t.$set(t.state,"title",e)},expression:"state.title"}}),a("el-select",{staticClass:"ml10",staticStyle:{width:"120px"},attrs:{placeholder:"Select language",clearable:""},on:{change:t.fetchData},model:{value:t.state.filterLanguage,callback:function(e){t.$set(t.state,"filterLanguage",e)},expression:"state.filterLanguage"}},t._l(t.languageOptions,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.state.tableData.loading,expression:"state.tableData.loading"}],staticStyle:{width:"100%"},attrs:{data:t.state.poemData,"row-key":"id"},on:{"row-click":t.viewPoemDetail}},[a("el-table-column",{attrs:{prop:"title",label:"Title",width:"180"}}),a("el-table-column",{attrs:{prop:"authorName",label:"Author",width:"120"}}),a("el-table-column",{attrs:{prop:"language",label:"Language",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.row;return[a("el-tag",{attrs:{size:"small"}},[t._v(t._s(s.language))])]}}])}),a("el-table-column",{attrs:{prop:"email",label:"Email",width:"180"}}),a("el-table-column",{attrs:{prop:"averageScore",label:"Average Score",width:"180"}}),a("el-table-column",{attrs:{prop:"likeCount",label:"Likes",width:"180"}}),a("el-table-column",{attrs:{label:"Actions",width:"280"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.row;return[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return e.stopPropagation(),t.setAsTodayPoem(s)}}},[t._v(" "+t._s(t.state.todayPoem&&t.state.todayPoem.id===s.id?"Remove Today's":"Set as Today's")+" ")]),a("el-button",{attrs:{size:"mini",type:"text",disabled:t.state.featuredPoems.length>=4&&!t.state.featuredPoems.some((function(t){return t.id===s.id}))},on:{click:function(e){return e.stopPropagation(),t.toggleFeaturedPoem(s)}}},[t._v(" "+t._s(t.state.featuredPoems.some((function(t){return t.id===s.id}))?"Remove Featured":"Set as Featured")+" ")]),a("el-button",{attrs:{size:"mini",type:"text",disabled:t.state.favoritePoems.length>=5&&!t.state.favoritePoems.some((function(t){return t.id===s.id}))},on:{click:function(e){return e.stopPropagation(),t.toggleFavoritePoem(s)}}},[t._v(" "+t._s(t.state.favoritePoems.some((function(t){return t.id===s.id}))?"Remove Favorite":"Set as Favorite")+" ")])]}}])})],1),a("el-pagination",{staticClass:"mt15",attrs:{"current-page":t.state.tableData.param.current,"page-sizes":[10,20,30],"page-size":t.state.tableData.param.limit,layout:"total, sizes, prev, pager, next, jumper",total:t.state.tableData.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)])]),a("el-dialog",{attrs:{title:"Poem Details",visible:t.state.detailDialogVisible,width:"600px","append-to-body":"",center:"",destro:""},on:{"update:visible":function(e){return t.$set(t.state,"detailDialogVisible",e)}}},[t.state.currentPoem?a("div",{staticClass:"poem-detail"},[a("div",{staticClass:"poem-detail-header"},[a("el-image",{staticClass:"poem-detail-image",attrs:{src:t.state.currentPoem.accessUrl,fit:"contain"}}),a("h2",[t._v(t._s(t.state.currentPoem.title))]),a("p",{staticClass:"author-info"},[t._v(" Author: "+t._s(t.state.currentPoem.authorName)+" "),t.state.currentPoem.email?a("span",[t._v("("+t._s(t.state.currentPoem.email)+")")]):t._e()]),a("el-tag",{staticClass:"mb10",attrs:{size:"small"}},[t._v(t._s(t.state.currentPoem.language))])],1),a("div",{staticClass:"poem-detail-content"},[a("p",[t._v(t._s(t.state.currentPoem.content))])]),a("div",{staticClass:"poem-detail-footer"},[a("p",{staticClass:"poem-date"},[t._v("Created: "+t._s(new Date(t.state.currentPoem.createTime).toLocaleString()))]),a("div",{staticClass:"poem-tags"},[t.state.todayPoem&&t.state.todayPoem.id===t.state.currentPoem.id?a("el-tag",{staticClass:"ml5",attrs:{type:"success",size:"small"}},[t._v("Today's Poem")]):t._e(),t.state.featuredPoems.some((function(e){return e.id===t.state.currentPoem.id}))?a("el-tag",{staticClass:"ml5",attrs:{size:"small"}},[t._v("Featured")]):t._e(),t.state.favoritePoems.some((function(e){return e.id===t.state.currentPoem.id}))?a("el-tag",{staticClass:"ml5",attrs:{type:"warning",size:"small"}},[t._v("Favorite")]):t._e()],1)])]):t._e()])],1)},i=[],o=(a("d793"),a("c127"),a("a15b"),a("8f24")),l=a("e1c7"),n={name:"poem",data(){return{languageOptions:[{value:"English",label:"English"},{value:"Chinese",label:"Chinese"},{value:"Spanish",label:"Spanish"},{value:"French",label:"French"},{value:"German",label:"German"},{value:"Japanese",label:"Japanese"},{value:"Korean",label:"Korean"}],state:{title:"",filterLanguage:"",todayPoem:null,featuredPoems:[],favoritePoems:[],poemData:[],tableData:{loading:!1,total:0,param:{current:1,limit:10}},detailDialogVisible:!1,currentPoem:null}}},methods:{async fetchData(){this.state.tableData.loading=!0;const t={...this.state.tableData.param,title:this.state.title,language:this.state.filterLanguage};console.log("入参",t),Object(l["usePoemApi"])().list(t).then(({data:t})=>{console.log("返回",t),t&&(this.state.poemData=t.records.map(t=>({...t,selected:!1})),this.state.tableData.total=t.total)}).finally(()=>{this.state.tableData.loading=!1}),Object(l["usePoemApi"])().list({...this.state.tableData.param,todaySign:1}).then(({data:t})=>{console.log("today",t.records),this.state.todayPoem=t.records[0]||null}),Object(l["usePoemApi"])().list({...this.state.tableData.param,handPickedSign:1}).then(({data:t})=>{console.log("featured",t.records),this.state.featuredPoems=t.records}),Object(l["usePoemApi"])().list({...this.state.tableData.param,favoriteSign:1}).then(({data:t})=>{console.log("favorite",t.records),this.state.favoritePoems=t.records})},async setAsTodayPoem(t){console.log("入参",t);const e=await Object(l["usePoemApi"])().update({id:t.id,todaySign:1});console.log("res",e),this.fetchData()},async toggleFeaturedPoem(t){const e=this.state.featuredPoems.some(e=>e.id===t.id),a=JSON.parse(JSON.stringify(t));a.handPickedSign=e?0:1,console.log("精选入参",a);const s=await Object(l["usePoemApi"])().update({id:a.id,handPickedSign:a.handPickedSign});console.log("精选结果",s),this.fetchData()},async toggleFavoritePoem(t){const e=this.state.favoritePoems.some(e=>e.id===t.id),a=JSON.parse(JSON.stringify(t));a.favoriteSign=e?0:1,console.log("喜欢入参",a);const s=await Object(l["usePoemApi"])().update({id:a.id,favoriteSign:a.favoriteSign});console.log("喜欢结果",s),this.fetchData()},handleFeaturedSelection(t){if(t.selected&&this.state.featuredPoems.length>=4)return t.selected=!1,void o["Message"].warning("You can select at most 4 featured poems");this.toggleFeaturedPoem(t)},handleFavoriteSelection(t){if(t.selected&&this.state.favoritePoems.length>=5)return t.selected=!1,void o["Message"].warning("You can select at most 5 favorite poems");this.toggleFavoritePoem(t)},handleSearchClear(){this.state.title="",this.fetchData()},handleSizeChange(t){this.state.tableData.param.limit=t,this.fetchData()},handleCurrentChange(t){this.state.tableData.param.current=t,this.fetchData()},viewPoemDetail(t){this.state.currentPoem=t,this.state.detailDialogVisible=!0}},mounted(){this.fetchData()}},r=n,c=(a("6087"),a("1805")),d=Object(c["a"])(r,s,i,!1,null,"15280668",null);e["default"]=d.exports},caab:function(t,e,a){},e1c7:function(t,e,a){"use strict";a.r(e),a.d(e,"usePoemApi",(function(){return i}));var s=a("b775");function i(){return{list:t=>Object(s["default"])({url:"/busi/poem/page",method:"get",params:t}),delete:t=>Object(s["default"])({url:"/busi/poem/delete",method:"POST",params:t}),update:t=>Object(s["default"])({url:"/busi/poem/update",method:"POST",data:t})}}}}]);